
---
title: "Mediation Analysis"
author: "ChatGPT 4o"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true            # 启用目录
    toc_float: true      # 目录浮动
    toc_depth: 3         # 设置目录的层级深度，可根据需要调整
    highlight: "tango"  # 代码块高亮样式
    theme: "journal"   # 设置主题
    self_contained: true # 生成独立的HTML文件
---
<style>
/* 设置全局行距和正文字号 */
body {
    line-height: 1.8;
    font-size: 18px; /* 正文的字体大小 */
}

/* 调整段落文字 */
p {
    line-height: 1.8;
    font-size: 18px;
}

/* 调整标题字体大小 */
h1 {
    font-size: 22px; /* 一级标题 */
}
h2 {
    font-size: 20px; /* 二级标题 */
}
h3 {
    font-size: 18px; /* 三级标题 */
}
h4, h5, h6 {
    font-size: 18px; /* 四级及以下标题 */
}

/* 可选：为标题添加间距 */
h1, h2, h3, h4, h5, h6 {
    margin-top: 20px;
    margin-bottom: 10px;
}
</style>
```{r include=FALSE}
par(family = "STKaiti")
library(showtext)
showtext_auto()
```
## 1 起源

中介分析（Mediation Analysis）是一种用于探讨因变量和自变量之间关系的统计方法，特别是在其中加入一个或多个中介变量的情况下。它最早由心理学家巴隆（Baron）和肯尼（Kenny）于1986年系统提出，用于揭示自变量如何通过中介变量间接影响因变量的机制。中介分析在社会科学、心理学和医学等领域广泛应用，有助于揭示变量之间更复杂的因果路径。

## 2 原理

中介分析的核心思想是通过引入中介变量（Mediator），探索自变量（X）对因变量（Y）的影响是否通过某一中间过程发生。中介分析通常包括以下三个主要路径：

1. **直接效应（Direct Effect）**：自变量对因变量的直接影响。
2. **间接效应（Indirect Effect）**：自变量通过中介变量对因变量的间接影响。
3. **总效应（Total Effect）**：自变量对因变量的总影响，即直接效应和间接效应之和。

数学模型可描述为：

- 路径 $a$：自变量 $X$ 对中介变量 $M$ 的影响。
- 路径 $b$：中介变量 $M$ 对因变量 $Y$ 的影响。
- 路径 $c'$：自变量 $X$ 对因变量 $Y$ 的直接效应。
- 间接效应为 $a \times b$，总效应为路径 $c$（即 $c = c' + ab$）。

中介效应的显著性通常使用引导抽样法（Bootstrapping）或Sobel检验来进行检验。

## 3 适用范围

中介分析适用于以下情况：

- **因果路径探讨**：希望探讨自变量如何通过中介变量影响因变量，从而揭示更为复杂的因果关系。
- **连续型或分类自变量**：自变量可以是连续型或分类变量，因变量通常是连续型变量。
- **数据符合线性回归假设**：中介分析建立在回归分析的基础上，数据应满足线性关系、正态性等基本假设。

## 4 应用情境

中介分析在众多领域中有着广泛的应用，例如：

- **心理学研究**：探讨压力如何通过焦虑影响个体的睡眠质量。
- **教育研究**：分析家庭经济状况如何通过学习资源影响学生的学业成绩。
- **社会科学**：研究社会地位如何通过社会支持影响个体的心理健康。
- **医学研究**：研究生活方式如何通过身体质量指数（BMI）影响心血管健康。

## 5 优缺点

### 优点

- **揭示中介机制**：中介分析能够揭示自变量对因变量影响的中间机制，帮助理解因果关系的复杂路径。
- **区分直接和间接效应**：可以量化自变量对因变量的直接和间接影响，从而更全面地理解变量之间的关系。
- **适用于多个领域**：广泛应用于心理学、社会学、教育学和医学等多个领域。

### 缺点

- **对因果推断的要求较高**：中介分析本质上是一种因果分析，需要谨慎对待自变量、中介变量和因变量之间的因果顺序和逻辑。
- **对数据的假设要求**：中介分析基于回归分析，对数据的线性关系、正态性和独立性有较高要求。
- **多重共线性问题**：如果自变量和中介变量之间存在较强的共线性，可能会影响结果的稳定性和解释力。

## 6 在R中的实现及结果解释
### 简单中介
在R中，中介分析可以通过`mediation`包中的`mediate()`函数实现。以下是一个实现示例：

```{r}
# 加载必要的包
library(mediation)

# 示例数据：自变量X、中介变量M和因变量Y
set.seed(123)
X <- rnorm(100, mean = 5, sd = 2)
M <- 0.5 * X + rnorm(100)
Y <- 0.3 * M + 0.2 * X + rnorm(100)

# 创建数据框
data <- data.frame(X = X, M = M, Y = Y)

# 进行回归分析
model.M <- lm(M ~ X, data = data)  # 路径 a
model.Y <- lm(Y ~ X + M, data = data)  # 路径 b 和 c'

# 中介分析
med_result <- mediate(model.M, model.Y, treat = "X", mediator = "M", boot = TRUE, sims = 500)

# 输出中介分析结果
summary(med_result)
```

#### 结果解释

- **ACME（Average Causal Mediation Effect）**：表示平均因果中介效应，即间接效应 $a \times b$，用于衡量自变量通过中介变量对因变量的影响。
- **ADE（Average Direct Effect）**：表示平均直接效应 $c'$，用于衡量自变量对因变量的直接影响。
- **Total Effect**：表示自变量对因变量的总效应，即直接效应和间接效应之和。
- **Prop. Mediated**：表示中介效应占总效应的比例，反映了中介变量在自变量和因变量关系中的作用大小。

如果ACME的p值小于显著性水平（如0.05），则可以认为中介效应显著，即自变量对因变量的影响部分是通过中介变量实现的。

#### 结果的可视化

可以使用`mediation`包中的`plot()`函数对中介分析的结果进行可视化，以展示直接效应和间接效应。

```{r}
# 可视化中介分析结果
plot(med_result)
```

上述代码将生成一个图形，展示ACME（间接效应）、ADE（直接效应）及其置信区间，通过图形可以直观地看到中介效应和直接效应的显著性。

### 多重中介分析

在实际研究中，可能存在多个中介变量同时影响自变量和因变量之间的关系，这种情况下可以进行多重中介分析（Multiple Mediation Analysis）。多重中介分析可以帮助我们了解自变量通过多个中介变量对因变量的影响路径，从而揭示更加复杂的因果机制。

在R中，可以使用`mediate()`函数处理多个中介变量。以下是一个多重中介分析的实现示例：

```{r}
# 加载必要的包
library(mediation)

# 示例数据：自变量X、中介变量M1和M2，以及因变量Y
set.seed(123)
X <- rnorm(100, mean = 5, sd = 2)
M1 <- 0.5 * X + rnorm(100)
M2 <- 0.4 * X + 0.3 * M1 + rnorm(100)
Y <- 0.3 * M1 + 0.2 * M2 + 0.1 * X + rnorm(100)

# 创建数据框
data <- data.frame(X = X, M1 = M1, M2 = M2, Y = Y)

# 进行回归分析
model.M1 <- lm(M1 ~ X, data = data)  # 路径 a1
model.M2 <- lm(M2 ~ X + M1, data = data)  # 路径 a2
model.Y <- lm(Y ~ X + M1 + M2, data = data)  # 路径 b1, b2 和 c'

# 多重中介分析
med_result1 <- mediate(model.M1, model.Y, treat = "X", mediator = "M1", boot = TRUE, sims = 500)
med_result2 <- mediate(model.M2, model.Y, treat = "X", mediator = "M2", boot = TRUE, sims = 500)

# 输出多重中介分析结果
summary(med_result1)
summary(med_result2)
```

#### 结果解释

- **多重中介效应**：在多重中介分析中，我们可以分别计算每个中介变量的中介效应（ACME），直接效应（ADE），以及总效应。每个中介变量的间接效应可以用于评估该中介变量在整体因果路径中的作用。
- **Prop. Mediated**：对于每个中介变量，可以计算中介效应占总效应的比例，反映每个中介变量在自变量和因变量关系中的贡献大小。

如果每个ACME的p值小于显著性水平（如0.05），则可以认为这些中介效应显著，即自变量对因变量的影响部分是通过这些中介变量实现的。

#### 结果的可视化

可以使用`plot()`函数对多重中介分析的结果进行可视化，以直观地展示每个中介变量的间接效应和直接效应。

```{r}
# 可视化多重中介分析结果
plot(med_result1)
plot(med_result2)
```

上述代码将生成两个图形，分别展示中介变量M1和M2的ACME（间接效应）、ADE（直接效应）及其置信区间。通过这些图形可以直观地比较各中介变量的中介效应和直接效应的显著性及其相对大小。

## 7 小结

- 中介分析是一种用于探索自变量通过中介变量对因变量的间接影响的统计方法。
- 适用于因果路径的探讨，能够揭示变量之间更复杂的因果关系。
- 具有揭示中介机制、区分直接和间接效应的优点，但对因果推断和数据的假设要求较高。
- 可以通过R中的`mediate()`函数实现中介分析，并结合可视化直观地展示结果。
- 在心理学、社会科学、教育和医学等多个领域中，中介分析是一种重要的工具，用于理解复杂的因果路径。










